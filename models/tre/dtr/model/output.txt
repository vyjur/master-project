Spawning shell within /cluster/home/julievt/.cache/pypoetry/virtualenvs/master-project-118ajfdt-py3.12
Installing dependencies from lock file

No dependencies to install or update

Installing the current project: master-project (0.1.0)
##### Start training for TRE... ######
### Processing the files:
###### (2) Training for configuration file: b-bert.ini
LOAD False
Using: cuda:0 with BERT
{'AFTER': 0, 'BEFORE': 1, 'OVERLAP': 2}
{0: 'AFTER', 1: 'BEFORE', 2: 'OVERLAP'}
{'BEFORE': 3864, 'OVERLAP': 2091, 'AFTER': 568}
{'AFTER': 3.8280516431924885, 'BEFORE': 0.5627156659765356, 'OVERLAP': 1.0398533397098677}
{'AFTER': 3.8280516431924885, 'BEFORE': 0.5627156659765356, 'OVERLAP': 1.0398533397098677}
Training Epoch: 0
Training loss epoch: 1.3092356319645888
Training accuracy epoch: 0.3309364776444929
Overall acc: 0.33205558217537134
Overall loss: 171.50986778736115
Validation loss per 100 evaluation steps: 0.9817304611206055
Validation Loss: 1.001576899579077
Validation Accuracy: 0.3399621212121212
Overall accuracy: 0.34099616858237547
Overall loss: 1.001576899579077
### Summary
              precision    recall  f1-score   support

       AFTER       0.00      0.00      0.00        97
      BEFORE       0.00      0.00      0.00       591
     OVERLAP       0.34      1.00      0.51       356

    accuracy                           0.34      1044
   macro avg       0.11      0.33      0.17      1044
weighted avg       0.12      0.34      0.17      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.00      0.00      0.00       591
       AFTER       0.00      0.00      0.00        97
     OVERLAP       0.34      1.00      0.51       356

    accuracy                           0.34      1044
   macro avg       0.11      0.33      0.17      1044
weighted avg       0.12      0.34      0.17      1044

Training Epoch: 1
Training loss epoch: 1.197782136101759
Training accuracy epoch: 0.3457947110141767
Overall acc: 0.34666986104456154
Overall loss: 156.90945982933044
Validation loss per 100 evaluation steps: 1.201742172241211
Validation Loss: 1.2085551565343684
Validation Accuracy: 0.0946969696969697
Overall accuracy: 0.09291187739463602
Overall loss: 1.2085551565343684
### Summary
              precision    recall  f1-score   support

       AFTER       0.09      1.00      0.17        97
      BEFORE       0.00      0.00      0.00       591
     OVERLAP       0.00      0.00      0.00       356

    accuracy                           0.09      1044
   macro avg       0.03      0.33      0.06      1044
weighted avg       0.01      0.09      0.02      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.00      0.00      0.00       591
       AFTER       0.09      1.00      0.17        97
     OVERLAP       0.00      0.00      0.00       356

    accuracy                           0.09      1044
   macro avg       0.03      0.33      0.06      1044
weighted avg       0.01      0.09      0.02      1044

Training Epoch: 2
Training loss epoch: 1.2276847735616088
Training accuracy epoch: 0.3397628135223555
Overall acc: 0.34091998083373265
Overall loss: 160.82670533657074
Validation loss per 100 evaluation steps: 1.3461894989013672
Validation Loss: 1.2467082621473256
Validation Accuracy: 0.5681818181818182
Overall accuracy: 0.5660919540229885
Overall loss: 1.2467082621473256
### Summary
              precision    recall  f1-score   support

       AFTER       0.00      0.00      0.00        97
      BEFORE       0.57      1.00      0.72       591
     OVERLAP       0.00      0.00      0.00       356

    accuracy                           0.57      1044
   macro avg       0.19      0.33      0.24      1044
weighted avg       0.32      0.57      0.41      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.57      1.00      0.72       591
       AFTER       0.00      0.00      0.00        97
     OVERLAP       0.00      0.00      0.00       356

    accuracy                           0.57      1044
   macro avg       0.19      0.33      0.24      1044
weighted avg       0.32      0.57      0.41      1044

Training Epoch: 3
Training loss epoch: 1.2051552406704154
Training accuracy epoch: 0.37656761177753545
Overall acc: 0.37757546717776713
Overall loss: 157.8753365278244
Validation loss per 100 evaluation steps: 1.5984958410263062
Validation Loss: 0.945487175023917
Validation Accuracy: 0.5634469696969697
Overall accuracy: 0.564176245210728
Overall loss: 0.945487175023917
### Summary
              precision    recall  f1-score   support

       AFTER       0.00      0.00      0.00        97
      BEFORE       0.58      0.97      0.73       591
     OVERLAP       0.26      0.04      0.06       356

    accuracy                           0.56      1044
   macro avg       0.28      0.34      0.26      1044
weighted avg       0.42      0.56      0.43      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.58      0.97      0.73       591
       AFTER       0.00      0.00      0.00        97
     OVERLAP       0.26      0.04      0.06       356

    accuracy                           0.56      1044
   macro avg       0.28      0.34      0.26      1044
weighted avg       0.42      0.56      0.43      1044

Training Epoch: 4
Training loss epoch: 1.0770575850064519
Training accuracy epoch: 0.4663645038167939
Overall acc: 0.46621945376137996
Overall loss: 141.09454363584518
Validation loss per 100 evaluation steps: 0.7730773091316223
Validation Loss: 0.8846927610310641
Validation Accuracy: 0.35795454545454547
Overall accuracy: 0.3563218390804598
Overall loss: 0.8846927610310641
### Summary
              precision    recall  f1-score   support

       AFTER       0.53      0.45      0.49        97
      BEFORE       0.00      0.00      0.00       591
     OVERLAP       0.34      0.92      0.50       356

    accuracy                           0.36      1044
   macro avg       0.29      0.46      0.33      1044
weighted avg       0.17      0.36      0.22      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.00      0.00      0.00       591
       AFTER       0.53      0.45      0.49        97
     OVERLAP       0.34      0.92      0.50       356

    accuracy                           0.36      1044
   macro avg       0.29      0.46      0.33      1044
weighted avg       0.17      0.36      0.22      1044

Training Epoch: 5
Training loss epoch: 0.9836400574400225
Training accuracy epoch: 0.5144833696837514
Overall acc: 0.514853857211308
Overall loss: 128.85684752464294
Validation loss per 100 evaluation steps: 0.8664787411689758
Validation Loss: 0.7100671710390033
Validation Accuracy: 0.6316287878787878
Overall accuracy: 0.6273946360153256
Overall loss: 0.7100671710390033
### Summary
              precision    recall  f1-score   support

       AFTER       0.53      0.75      0.62        97
      BEFORE       0.65      0.95      0.77       591
     OVERLAP       0.49      0.06      0.10       356

    accuracy                           0.63      1044
   macro avg       0.56      0.59      0.50      1044
weighted avg       0.58      0.63      0.53      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.65      0.95      0.77       591
       AFTER       0.53      0.75      0.62        97
     OVERLAP       0.49      0.06      0.10       356

    accuracy                           0.63      1044
   macro avg       0.56      0.59      0.50      1044
weighted avg       0.58      0.63      0.53      1044

Training Epoch: 6
Training loss epoch: 0.7894489266945206
Training accuracy epoch: 0.5959651035986914
Overall acc: 0.5960709151892669
Overall loss: 103.4178093969822
Validation loss per 100 evaluation steps: 0.4445473253726959
Validation Loss: 0.6675402928482402
Validation Accuracy: 0.6922348484848485
Overall accuracy: 0.6944444444444444
Overall loss: 0.6675402928482402
### Summary
              precision    recall  f1-score   support

       AFTER       0.53      0.71      0.61        97
      BEFORE       0.77      0.81      0.79       591
     OVERLAP       0.61      0.49      0.54       356

    accuracy                           0.69      1044
   macro avg       0.64      0.67      0.65      1044
weighted avg       0.69      0.69      0.69      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.77      0.81      0.79       591
       AFTER       0.53      0.71      0.61        97
     OVERLAP       0.61      0.49      0.54       356

    accuracy                           0.69      1044
   macro avg       0.64      0.67      0.65      1044
weighted avg       0.69      0.69      0.69      1044

Training Epoch: 7
Training loss epoch: 0.7397106970084533
Training accuracy epoch: 0.6321224100327153
Overall acc: 0.6317680881648299
Overall loss: 96.90210130810738
Validation loss per 100 evaluation steps: 0.8072829246520996
Validation Loss: 0.7812788369077625
Validation Accuracy: 0.6126893939393939
Overall accuracy: 0.6139846743295019
Overall loss: 0.7812788369077625
### Summary
              precision    recall  f1-score   support

       AFTER       0.52      0.79      0.63        97
      BEFORE       0.90      0.48      0.63       591
     OVERLAP       0.48      0.78      0.60       356

    accuracy                           0.61      1044
   macro avg       0.63      0.69      0.62      1044
weighted avg       0.72      0.61      0.62      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.90      0.48      0.63       591
       AFTER       0.52      0.79      0.63        97
     OVERLAP       0.48      0.78      0.60       356

    accuracy                           0.61      1044
   macro avg       0.63      0.69      0.62      1044
weighted avg       0.72      0.61      0.62      1044

Training Epoch: 8
Training loss epoch: 0.6072495033722798
Training accuracy epoch: 0.7061409487459106
Overall acc: 0.7057977958792525
Overall loss: 79.54968494176865
Validation loss per 100 evaluation steps: 0.5969671010971069
Validation Loss: 0.5903408888614539
Validation Accuracy: 0.7509469696969697
Overall accuracy: 0.7480842911877394
Overall loss: 0.5903408888614539
### Summary
              precision    recall  f1-score   support

       AFTER       0.59      0.88      0.70        97
      BEFORE       0.87      0.76      0.81       591
     OVERLAP       0.64      0.69      0.66       356

    accuracy                           0.75      1044
   macro avg       0.70      0.78      0.73      1044
weighted avg       0.77      0.75      0.75      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.87      0.76      0.81       591
       AFTER       0.59      0.88      0.70        97
     OVERLAP       0.64      0.69      0.66       356

    accuracy                           0.75      1044
   macro avg       0.70      0.78      0.73      1044
weighted avg       0.77      0.75      0.75      1044

Training Epoch: 9
Training loss epoch: 0.4952268624351225
Training accuracy epoch: 0.7673800436205016
Overall acc: 0.7676090081456637
Overall loss: 64.87471897900105
Validation loss per 100 evaluation steps: 0.39090365171432495
Validation Loss: 0.523069732794256
Validation Accuracy: 0.7926136363636364
Overall accuracy: 0.7931034482758621
Overall loss: 0.523069732794256
### Summary
              precision    recall  f1-score   support

       AFTER       0.72      0.70      0.71        97
      BEFORE       0.83      0.90      0.86       591
     OVERLAP       0.75      0.64      0.69       356

    accuracy                           0.79      1044
   macro avg       0.77      0.75      0.75      1044
weighted avg       0.79      0.79      0.79      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.83      0.90      0.86       591
       AFTER       0.72      0.70      0.71        97
     OVERLAP       0.75      0.64      0.69       356

    accuracy                           0.79      1044
   macro avg       0.77      0.75      0.75      1044
weighted avg       0.79      0.79      0.79      1044

Training Epoch: 10
Training loss epoch: 0.3943300492890919
Training accuracy epoch: 0.8110346237731734
Overall acc: 0.8114518447532343
Overall loss: 51.65723645687103
Validation loss per 100 evaluation steps: 0.4762485921382904
Validation Loss: 0.7016238935969092
Validation Accuracy: 0.7073863636363636
Overall accuracy: 0.7097701149425287
Overall loss: 0.7016238935969092
### Summary
              precision    recall  f1-score   support

       AFTER       0.64      0.75      0.69        97
      BEFORE       0.70      0.97      0.82       591
     OVERLAP       0.82      0.27      0.40       356

    accuracy                           0.71      1044
   macro avg       0.72      0.66      0.64      1044
weighted avg       0.74      0.71      0.66      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.70      0.97      0.82       591
       AFTER       0.64      0.75      0.69        97
     OVERLAP       0.82      0.27      0.40       356

    accuracy                           0.71      1044
   macro avg       0.72      0.66      0.64      1044
weighted avg       0.74      0.71      0.66      1044

Training Epoch: 11
Training loss epoch: 0.7311493491625968
Training accuracy epoch: 0.6664053980370774
Overall acc: 0.6665069477719214
Overall loss: 95.78056474030018
Validation loss per 100 evaluation steps: 0.9832701086997986
Validation Loss: 0.9817724155657219
Validation Accuracy: 0.3465909090909091
Overall accuracy: 0.3448275862068966
Overall loss: 0.9817724155657219
### Summary
              precision    recall  f1-score   support

       AFTER       0.53      0.10      0.17        97
      BEFORE       1.00      0.00      0.00       591
     OVERLAP       0.34      0.98      0.51       356

    accuracy                           0.34      1044
   macro avg       0.62      0.36      0.23      1044
weighted avg       0.73      0.34      0.19      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       1.00      0.00      0.00       591
       AFTER       0.53      0.10      0.17        97
     OVERLAP       0.34      0.98      0.51       356

    accuracy                           0.34      1044
   macro avg       0.62      0.36      0.23      1044
weighted avg       0.73      0.34      0.19      1044

Training Epoch: 12
Training loss epoch: 1.13922021816705
Training accuracy epoch: 0.42901444929116683
Overall acc: 0.4293243890752276
Overall loss: 149.23784857988358
Validation loss per 100 evaluation steps: 0.9023897051811218
Validation Loss: 0.822875285690481
Validation Accuracy: 0.5785984848484849
Overall accuracy: 0.5823754789272031
Overall loss: 0.822875285690481
### Summary
              precision    recall  f1-score   support

       AFTER       0.00      0.00      0.00        97
      BEFORE       0.80      0.55      0.65       591
     OVERLAP       0.44      0.79      0.57       356

    accuracy                           0.58      1044
   macro avg       0.41      0.45      0.41      1044
weighted avg       0.60      0.58      0.56      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.80      0.55      0.65       591
       AFTER       0.00      0.00      0.00        97
     OVERLAP       0.44      0.79      0.57       356

    accuracy                           0.58      1044
   macro avg       0.41      0.45      0.41      1044
weighted avg       0.60      0.58      0.56      1044

Training Epoch: 13
Training loss epoch: 1.0260359462890916
Training accuracy epoch: 0.4787350054525627
Overall acc: 0.4798754192620987
Overall loss: 134.410708963871
Validation loss per 100 evaluation steps: 0.9147711992263794
Validation Loss: 1.0822050788185813
Validation Accuracy: 0.5596590909090909
Overall accuracy: 0.5660919540229885
Overall loss: 1.0822050788185813
### Summary
              precision    recall  f1-score   support

       AFTER       0.00      0.00      0.00        97
      BEFORE       0.57      1.00      0.72       591
     OVERLAP       0.00      0.00      0.00       356

    accuracy                           0.57      1044
   macro avg       0.19      0.33      0.24      1044
weighted avg       0.32      0.57      0.41      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.57      1.00      0.72       591
       AFTER       0.00      0.00      0.00        97
     OVERLAP       0.00      0.00      0.00       356

    accuracy                           0.57      1044
   macro avg       0.19      0.33      0.24      1044
weighted avg       0.32      0.57      0.41      1044

Training Epoch: 14
Training loss epoch: 1.1801025899311968
Training accuracy epoch: 0.39602644492911665
Overall acc: 0.39650215620507906
Overall loss: 154.5934392809868
Validation loss per 100 evaluation steps: 1.8381483554840088
Validation Loss: 1.8515368862585588
Validation Accuracy: 0.0946969696969697
Overall accuracy: 0.09291187739463602
Overall loss: 1.8515368862585588
### Summary
              precision    recall  f1-score   support

       AFTER       0.09      1.00      0.17        97
      BEFORE       0.00      0.00      0.00       591
     OVERLAP       0.00      0.00      0.00       356

    accuracy                           0.09      1044
   macro avg       0.03      0.33      0.06      1044
weighted avg       0.01      0.09      0.02      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.00      0.00      0.00       591
       AFTER       0.09      1.00      0.17        97
     OVERLAP       0.00      0.00      0.00       356

    accuracy                           0.09      1044
   macro avg       0.03      0.33      0.06      1044
weighted avg       0.01      0.09      0.02      1044

Early stopping
### Valid set performance:
Validation loss per 100 evaluation steps: 1.6036713123321533
Validation Loss: 1.85691863117796
Validation Accuracy: 0.09185606060606061
Overall accuracy: 0.09291187739463602
Overall loss: 1.85691863117796
### Summary
              precision    recall  f1-score   support

       AFTER       0.09      1.00      0.17        97
      BEFORE       0.00      0.00      0.00       591
     OVERLAP       0.00      0.00      0.00       356

    accuracy                           0.09      1044
   macro avg       0.03      0.33      0.06      1044
weighted avg       0.01      0.09      0.02      1044

### Without O
              precision    recall  f1-score   support

      BEFORE       0.00      0.00      0.00       591
       AFTER       0.09      1.00      0.17        97
     OVERLAP       0.00      0.00      0.00       356

    accuracy                           0.09      1044
   macro avg       0.03      0.33      0.06      1044
weighted avg       0.01      0.09      0.02      1044

### Test set performance:
Validation loss per 100 evaluation steps: 1.929862380027771
Validation Loss: 1.8591496857201182
Validation Accuracy: 0.09205623306233061
Overall accuracy: 0.09195402298850575
Overall loss: 1.8591496857201182
### Summary
              precision    recall  f1-score   support

       AFTER       0.09      1.00      0.17       120
      BEFORE       0.00      0.00      0.00       746
     OVERLAP       0.00      0.00      0.00       439

    accuracy                           0.09      1305
   macro avg       0.03      0.33      0.06      1305
weighted avg       0.01      0.09      0.02      1305

### Without O
              precision    recall  f1-score   support

      BEFORE       0.00      0.00      0.00       746
       AFTER       0.09      1.00      0.17       120
     OVERLAP       0.00      0.00      0.00       439

    accuracy                           0.09      1305
   macro avg       0.03      0.33      0.06      1305
weighted avg       0.01      0.09      0.02      1305

Finished with this task. 
 

Process finished!
