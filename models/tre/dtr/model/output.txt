Spawning shell within /cluster/home/julievt/.cache/pypoetry/virtualenvs/master-project-118ajfdt-py3.12
Installing dependencies from lock file

No dependencies to install or update

Installing the current project: master-project (0.1.0)
##### Start training for TRE... ######
### Processing the files:
###### (2) Training for configuration file: b-bert.ini
LOAD False
Using: cuda:0 with BERT
{'AFTER': 0, 'BEFORE': 1, 'BEFOREOVERLAP': 2, 'OVERLAP': 3}
{0: 'AFTER', 1: 'BEFORE', 2: 'BEFOREOVERLAP', 3: 'OVERLAP'}
[1, 22544, 342, 8690, 26341, 1929, 459, 416, 367, 397, 4360, 351, 363, 6404, 27987, 4408, 333, 40861, 946, 340, 1969, 16710, 2025, 333, 9122, 24610, 365, 351, 43947, 342, 368, 1769, 351, 20889, 368, 12295, 3961, 1359, 29415, 355, 2654, 34627, 5148, 416, 2515, 9463, 537, 1359, 2025, 2025, 10217, 27987, 458, 584, 32054, 6017, 1359, 459, 1486, 816, 1125, 10929, 171, 368, 22544, 1359, 4408, 1118, 9104, 7556, 344, 1748, 41183, 322, 36560, 614, 1969, 13004, 1359, 1969, 526, 7076, 5623, 3748, 1359, 13925, 920, 6043, 120, 556, 120, 2120, 2154, 8528, 127, 484, 24973, 7076, 8387, 1969, 11477, 1118, 17818, 2025, 18593, 15327, 8860, 1673, 335, 1818, 10405, 623, 42680, 122, 29297, 31006, 143, 43721, 42238, 1359, 363, 13943, 1438, 2315, 3009, 544, 15576, 39300, 407, 9006, 13742, 2170, 2810, 19570, 333, 3051, 532, 375, 395, 2025, 445, 183, 915, 730, 414, 2025, 2025, 14325, 1961, 561, 3244, 2025, 351, 3051, 623, 441, 2025, 1384, 2627, 617, 4426, 333, 3051, 532, 1384, 2627, 1733, 48234, 189, 2951, 19570, 3314, 177, 1969, 13004, 1359, 1969, 526, 1118, 13082, 1230, 1118, 484, 735, 2819, 171, 1733, 28318, 3056, 324, 1733, 22249, 6703, 47193, 151, 3977, 188, 8287, 1904, 731, 4408, 484, 33055, 732, 459, 1118, 6043, 1359, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]
['[CLS]', 'Ġbaksiden', 'Ġog', 'Ġleveres', 'Ġrekvir', 'enten', 'Ġ(', 'Ġden', 'Ġsom', 'Ġhar', 'Ġplikt', 'Ġtil', 'ĠÃ¥', 'Ġmelde', 'ĠdÃ¸dsfallet', 'Ġ)', 'Ġi', 'Ġforseg', 'let', 'Ġk', 'Ġ,', 'Ġsog', 'Ġ|', 'Ġi', 'Ġbyene', 'Ġadresser', 'es', 'Ġtil', 'Ġskifteretten', 'Ġog', 'ĠpÃ¥', 'Ġlandet', 'Ġtil', 'Ġlensmannen', 'ĠpÃ¥', 'ĠdÃ¸ds', 'stedet', 'Ġ.', 'ĠKopi', 'Ġav', 'Ġlege', 'erklÃ¦ringen', 'Ġsendes', 'Ġden', 'Ġlokale', 'Ġpolitim', 'yr', 'Ġ.', 'Ġ|', 'Ġ|', 'ĠVa', 'ĠdÃ¸dsfallet', 'Ġkan', 'ĠvÃ¦re', 'Ġunatur', 'lia', 'Ġ.', 'Ġ(', 'ĠSe', 'Ġrett', 'led', 'nin', 'a', 'ĠpÃ¥', 'Ġbaksiden', 'Ġ.', 'Ġ)', 'ĠÃħ', 'ĠAN', 'ĠtrÃ¥', 'ed', 'Ġ/', 'ĠIc', 'or', 'ĠFÃ¸dt', 'Ġdag', 'Ġ,', 'Ġmnd', 'Ġ.', 'Ġ,', 'ĠÃ¥r', 'Ġ!', 'ĠPerson', 'nr', 'Ġ.', 'Ġ750', 'Ġ0', 'Ġ06', '.', '01', '.', '15', 'Ġ40', '76', '5', 'Ġ-', 'Ġ]', 'Ġ!', 'ĠDahl', 'Ġ,', 'ĠReidar', 'ĠÃħ', 'ĠAa', 'Ġ|', 'ĠFyr', 'uv', 'egen', 'Ġ22', 'Ġh', 'Ġpost', 'adresse', 'Ġ4', 'Ġ267', '0', 'ĠOtta', 'ĠNES', 'E', 'ĠEE', 'ĠRee', 'Ġ.', 'ĠÃ¥', 'ĠNR', 'ĠEt', 'ĠEU', 'ĠLa', 'ĠsÃ¥', 'Ġast', 'itus', 'jon', 'ĠAR', 'ĠâĤ¬', 'ĠUnder', 'Ġtransport', 'ĠDÃ¸d', 'Ġi', 'Ġsykehus', 'Ġeller', 'ĠS', 'Ġ1', 'Ġ|', 'Ġr', 'm', 'jem', 'me', 'Ġ2', 'Ġ|', 'Ġ|', 'ĠAnnet', 'sted', 'Ġ3', 'Ġ[', 'Ġ|', 'Ġtil', 'Ġsykehus', 'Ġ4', 'ĠK', 'Ġ|', 'Ġannen', 'Ġinstitusjon', 'ĠFor', 'ĠdÃ¸de', 'Ġi', 'Ġsykehus', 'Ġeller', 'Ġannen', 'Ġinstitusjon', 'Ġ:', 'ĠInstitusjonen', 's', 'Ġnavn', 'ĠDÃ¸d', 'ĠdÃ¥', 'g', 'Ġ,', 'Ġmnd', 'Ġ.', 'Ġ,', 'ĠÃ¥r', 'ĠÃħ', 'KE', 'Ġten', 'ĠÃħ', 'Ġ-', 'Ġnor', 'ĠÃħr', 'a', 'Ġ:', 'ĠKA', 'Ġpe', 'Ġo', 'Ġ:', 'ĠAA', 'ĠNM', 'NI', 'M', 'VE', 'r', 'mi', 'erer', 'ry', 'Ġ)', 'Ġ-', 'Ġgt', 'Ġ6', 'Ġ(', 'ĠÃħ', 'Ġ06', 'Ġ.', '[SEP]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]', '[PAD]']
OVERLAP
{'BEFORE': 25850, 'OVERLAP': 8521, 'BEFOREOVERLAP': 1042, 'AFTER': 2301}
{'BEFORE': 0.36473887814313344, 'OVERLAP': 1.106501584321089, 'BEFOREOVERLAP': 9.048464491362765, 'AFTER': 4.097566275532377}
Training Epoch: 0
Training loss epoch: 1.0269846088356442
Training accuracy epoch: 0.41335978835978837
Overall acc: 0.4134487901889294
Overall loss: 388.2001821398735
Validation loss per 100 evaluation steps: 0.9359641671180725
Validation loss per 100 evaluation steps: 1.0020684375621305
Validation loss per 100 evaluation steps: 1.0255464617885761
Validation loss per 100 evaluation steps: 1.0043847588605659
Validation loss per 100 evaluation steps: 1.0072555805085008
Validation Loss: 1.002988693320145
Validation Accuracy: 0.640625
Overall accuracy: 0.6401962084051438
Overall loss: 1.002988693320145
Training Epoch: 1
Training loss epoch: 0.9473360661791745
Training accuracy epoch: 0.5719659391534392
Overall acc: 0.5721329134902221
Overall loss: 358.093033015728
Validation loss per 100 evaluation steps: 0.769739031791687
Validation loss per 100 evaluation steps: 1.114207676141569
Validation loss per 100 evaluation steps: 1.1021688589409215
Validation loss per 100 evaluation steps: 1.1044867985272329
Validation loss per 100 evaluation steps: 1.101987524817412
Validation Loss: 1.1019772861973713
Validation Accuracy: 0.5380599273607748
Overall accuracy: 0.5378496619382208
Overall loss: 1.1019772861973713
Training Epoch: 2
Training loss epoch: 0.8833558516842979
Training accuracy epoch: 0.6168154761904762
Overall acc: 0.6165064633742128
Overall loss: 333.9085119366646
Validation loss per 100 evaluation steps: 0.8804879188537598
Validation loss per 100 evaluation steps: 0.9678337228770303
Validation loss per 100 evaluation steps: 0.975204202962752
Validation loss per 100 evaluation steps: 0.9507160849151421
Validation loss per 100 evaluation steps: 0.9438359700236237
Validation Loss: 0.9531632164272211
Validation Accuracy: 0.6281023002421308
Overall accuracy: 0.6279994697070131
Overall loss: 0.9531632164272211
Training Epoch: 3
Training loss epoch: 0.85177170741495
Training accuracy epoch: 0.646618716931217
Overall acc: 0.6466688763672522
Overall loss: 321.9697054028511
Validation loss per 100 evaluation steps: 0.6767231822013855
Validation loss per 100 evaluation steps: 0.8962134565457259
Validation loss per 100 evaluation steps: 0.901168538563287
Validation loss per 100 evaluation steps: 0.9015025138062892
Validation loss per 100 evaluation steps: 0.8951364497740073
Validation Loss: 0.9012694254012431
Validation Accuracy: 0.6709102602905569
Overall accuracy: 0.6706880551504706
Overall loss: 0.9012694254012431
Training Epoch: 4
Training loss epoch: 0.835937861727659
Training accuracy epoch: 0.6567460317460317
Overall acc: 0.6568196884322174
Overall loss: 315.9845117330551
Validation loss per 100 evaluation steps: 0.8580794334411621
Validation loss per 100 evaluation steps: 0.9780577244144855
Validation loss per 100 evaluation steps: 0.9825360914367941
Validation loss per 100 evaluation steps: 0.9731274682818061
Validation loss per 100 evaluation steps: 0.9717064538501444
Validation Loss: 0.9649711631364741
Validation Accuracy: 0.614860774818402
Overall accuracy: 0.6147421450351319
Overall loss: 0.9649711631364741
Training Epoch: 5
Training loss epoch: 0.7889613272651793
Training accuracy epoch: 0.6827876984126984
Overall acc: 0.6832117998011269
Overall loss: 298.2273817062378
Validation loss per 100 evaluation steps: 1.0847032070159912
Validation loss per 100 evaluation steps: 0.9057263354263684
Validation loss per 100 evaluation steps: 0.9346241580313118
Validation loss per 100 evaluation steps: 0.9293970767643761
Validation loss per 100 evaluation steps: 0.9355494018802024
Validation Loss: 0.9339201239458585
Validation Accuracy: 0.6430273910411622
Overall accuracy: 0.6431128198329578
Overall loss: 0.9339201239458585
Training Epoch: 6
Training loss epoch: 0.7795653384198588
Training accuracy epoch: 0.681588955026455
Overall acc: 0.6814302287040106
Overall loss: 294.6756979227066
Validation loss per 100 evaluation steps: 0.761614203453064
Validation loss per 100 evaluation steps: 0.8898073127954313
Validation loss per 100 evaluation steps: 0.908313280166085
Validation loss per 100 evaluation steps: 0.9098156239107201
Validation loss per 100 evaluation steps: 0.9150566588762098
Validation Loss: 0.9213883175309432
Validation Accuracy: 0.6963529055690073
Overall accuracy: 0.6966724115073578
Overall loss: 0.9213883175309432
Training Epoch: 7
Training loss epoch: 0.8043683948655608
Training accuracy epoch: 0.6746445105820106
Overall acc: 0.6750497182631754
Overall loss: 304.051253259182
Validation loss per 100 evaluation steps: 0.952335000038147
Validation loss per 100 evaluation steps: 0.9717854999079563
Validation loss per 100 evaluation steps: 0.9672647428453265
Validation loss per 100 evaluation steps: 0.9675824221384486
Validation loss per 100 evaluation steps: 0.9575191802366119
Validation Loss: 0.9560111510425301
Validation Accuracy: 0.6430652239709443
Overall accuracy: 0.6429802465862389
Overall loss: 0.9560111510425301
Training Epoch: 8
Training loss epoch: 0.796956032356888
Training accuracy epoch: 0.6772486772486772
Overall acc: 0.6773699038780245
Overall loss: 301.2493802309036
Validation loss per 100 evaluation steps: 1.0365464687347412
Validation loss per 100 evaluation steps: 0.9733965886701451
Validation loss per 100 evaluation steps: 0.9470187805185271
Validation loss per 100 evaluation steps: 0.9583699207171253
Validation loss per 100 evaluation steps: 0.9598198730006182
Validation Loss: 0.9556429946195271
Validation Accuracy: 0.645259533898305
Overall accuracy: 0.6448362720403022
Overall loss: 0.9556429946195271
Early stopping
### Valid set performance:
Validation loss per 100 evaluation steps: 1.5875890254974365
Validation loss per 100 evaluation steps: 0.9927867229032045
Validation loss per 100 evaluation steps: 0.9733403752099222
Validation loss per 100 evaluation steps: 0.9797428952301064
Validation Loss: 0.9704232819812008
Validation Accuracy: 0.6417548500881834
Overall accuracy: 0.6424192212096106
Overall loss: 0.9704232819812008
### Summary
               precision    recall  f1-score   support

        AFTER       0.00      0.00      0.00       399
       BEFORE       0.90      0.65      0.76      4111
BEFOREOVERLAP       0.00      0.00      0.00       170
      OVERLAP       0.39      0.88      0.54      1355

     accuracy                           0.64      6035
    macro avg       0.32      0.38      0.32      6035
 weighted avg       0.70      0.64      0.64      6035

### Test set performance:
Validation loss per 100 evaluation steps: 0.8190068602561951
Validation loss per 100 evaluation steps: 0.9705986235991563
Validation loss per 100 evaluation steps: 0.9561152941551968
Validation loss per 100 evaluation steps: 0.9542882604852467
Validation loss per 100 evaluation steps: 0.9551351473218485
Validation Loss: 0.95567748455678
Validation Accuracy: 0.6450892857142857
Overall accuracy: 0.6448362720403022
Overall loss: 0.95567748455678
### Summary
               precision    recall  f1-score   support

        AFTER       0.00      0.00      0.00       467
       BEFORE       0.90      0.66      0.76      5135
BEFOREOVERLAP       0.00      0.00      0.00       227
      OVERLAP       0.39      0.87      0.54      1714

     accuracy                           0.64      7543
    macro avg       0.32      0.38      0.33      7543
 weighted avg       0.70      0.64      0.64      7543

Finished with this task. 
 

Process finished!
