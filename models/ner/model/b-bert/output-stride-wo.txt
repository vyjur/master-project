Spawning shell within /cluster/home/julievt/.cache/pypoetry/virtualenvs/master-project-118ajfdt-py3.12
Installing dependencies from lock file

No dependencies to install or update

Installing the current project: master-project (0.1.0)
##### Start training for NER... ######
### Processing the files:
###### (0) Training for configuration file: blocked
###### (1) Training for configuration file: a-bilstmcrf.ini
###### (2) Training for configuration file: c-bert-bilstmcrf.ini
###### (3) Training for configuration file: b-bert.ini
LOAD False
{'B-CONDITION': 0, 'B-TREATMENT': 1, 'I-CONDITION': 2, 'I-TREATMENT': 3, 'O': 4} {0: 'B-CONDITION', 1: 'B-TREATMENT', 2: 'I-CONDITION', 3: 'I-TREATMENT', 4: 'O'}
Using: cuda:0 with BERT
{'B-CONDITION': 0, 'B-TREATMENT': 1, 'I-CONDITION': 2, 'I-TREATMENT': 3, 'O': 4}
{0: 'B-CONDITION', 1: 'B-TREATMENT', 2: 'I-CONDITION', 3: 'I-TREATMENT', 4: 'O'}
[1, 2964, 160, 22446, 1840, 3244, 336, 2025, 765, 24973, 1051, 1748, 325, 190, 1320, 442, 6301, 7817, 510, 124, 1475, 5220, 4917, 606, 28348, 363, 978, 4113, 46940, 14271, 163, 8706, 46739, 473, 15622, 374, 317, 556, 45993, 149, 9589, 8034, 11978, 15047, 9104, 23849, 36820, 33344, 27710, 8677, 31422, 4583, 644, 10512, 128, 5205, 143, 408, 125, 1517, 408, 123, 35817, 2]
['[CLS]', 'ĠNO', 'V', 'Ġnan', 'Ġ*', 'Ġ[', 'Ġv', 'Ġ|', 'Ġ200', 'Ġ]', 'Ġ15', 'Ġ/', 'Ġd', 't', 'ĠhÃ¸', 'ot', 'Ġ250', '89', 'ĠG', '2', 'ĠInn', 'komst', 'rapport', 'Ġle', 'pu', 'ĠÃ¥', 'Ġty', 'th', 'Ġbt', 'ĠSA', 'Y', 'ĠAP', 'PO', 'ĠP', 'IE', 'ĠD', 'Ġs', '01', 'ĠDO', 'K', 'UM', 'ENT', 'ASJON', 'ĠFRA', 'ĠAN', 'NET', 'ĠFAG', 'PER', 'SO', 'NE', 'LL', 'Ġim', 'Ġ5', 'Ġ1500', '6', 'ĠSK', 'E', 'ĠH', '3', 'Ġ25', 'ĠH', '1', 'ĠFysi', '[SEP]']
['O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O']
{'O': 306327, 'B-CONDITION': 15600, 'I-CONDITION': 18755, 'B-TREATMENT': 3124, 'I-TREATMENT': 4866}
{'O': 0.2276469263238304, 'B-CONDITION': 4.470153846153846, 'I-CONDITION': 3.7181764862703277, 'B-TREATMENT': 22.32215108834827, 'I-TREATMENT': 14.33094944512947}
Training Epoch: 0
Training loss epoch: 0.31075939908623695
Training accuracy epoch: 0.8450474330357143
Overall acc: 0.8474119693057947
Overall loss: 8.701263174414635
Validation loss per 100 evaluation steps: 0.5317679643630981
Validation Loss: 0.46654119874749866
Validation Accuracy: 0.8880580357142858
Overall accuracy: 0.8884174311926606
Overall loss: 0.46654119874749866
Training Epoch: 1
Training loss epoch: 0.1375794354826212
Training accuracy epoch: 0.8829694475446429
Overall acc: 0.8834131167527252
Overall loss: 3.8522241935133934
Validation loss per 100 evaluation steps: 0.3468284606933594
Validation Loss: 0.4010463186672756
Validation Accuracy: 0.9103097098214286
Overall accuracy: 0.912141628440367
Overall loss: 0.4010463186672756
Training Epoch: 2
Training loss epoch: 0.07843913497137171
Training accuracy epoch: 0.9130961100260417
Overall acc: 0.9125564759036144
Overall loss: 2.196295779198408
Validation loss per 100 evaluation steps: 0.29547667503356934
Validation Loss: 0.3752958936350686
Validation Accuracy: 0.9173130580357143
Overall accuracy: 0.9163274082568807
Overall loss: 0.3752958936350686
Training Epoch: 3
Training loss epoch: 0.054716700688004494
Training accuracy epoch: 0.920083472842262
Overall acc: 0.9204137980493402
Overall loss: 1.5320676192641258
Validation loss per 100 evaluation steps: 0.3011780083179474
Validation Loss: 0.30088839658669064
Validation Accuracy: 0.9324079241071429
Overall accuracy: 0.9326978211009175
Overall loss: 0.30088839658669064
Training Epoch: 4
Training loss epoch: 0.03526097210124135
Training accuracy epoch: 0.9537379673549108
Overall acc: 0.9545458620195066
Overall loss: 0.9873072188347578
Validation loss per 100 evaluation steps: 0.3241443336009979
Validation Loss: 0.25684835836291314
Validation Accuracy: 0.9359654017857143
Overall accuracy: 0.9348480504587156
Overall loss: 0.25684835836291314
Training Epoch: 5
Training loss epoch: 0.02406403495530997
Training accuracy epoch: 0.9657953171502976
Overall acc: 0.9654779833620195
Overall loss: 0.6737929787486792
Validation loss per 100 evaluation steps: 0.14425179362297058
Validation Loss: 0.27098781124638793
Validation Accuracy: 0.9467912946428572
Overall accuracy: 0.9453268348623853
Overall loss: 0.27098781124638793
Training Epoch: 6
Training loss epoch: 0.017296861557822143
Training accuracy epoch: 0.9743228004092261
Overall acc: 0.9744648235800344
Overall loss: 0.48431212361902
Validation loss per 100 evaluation steps: 0.18011462688446045
Validation Loss: 0.24732905989097032
Validation Accuracy: 0.9496651785714286
Overall accuracy: 0.9482798165137615
Overall loss: 0.24732905989097032
Training Epoch: 7
Training loss epoch: 0.010728512441606395
Training accuracy epoch: 0.9819513230096727
Overall acc: 0.9820442484222605
Overall loss: 0.30039834836497903
Validation loss per 100 evaluation steps: 0.2188718318939209
Validation Loss: 0.2691690002168928
Validation Accuracy: 0.9448102678571428
Overall accuracy: 0.9471616972477064
Overall loss: 0.2691690002168928
Training Epoch: 8
Training loss epoch: 0.0078460315292302
Training accuracy epoch: 0.9859624953497024
Overall acc: 0.9856703600114745
Overall loss: 0.21968888281844556
Validation loss per 100 evaluation steps: 0.3509461581707001
Validation Loss: 0.2815252519079617
Validation Accuracy: 0.9516183035714286
Overall accuracy: 0.9513618119266055
Overall loss: 0.2815252519079617
Training Epoch: 9
Training loss epoch: 0.006800845398434571
Training accuracy epoch: 0.9870294480096726
Overall acc: 0.9867819492254734
Overall loss: 0.19042367115616798
Validation loss per 100 evaluation steps: 0.26722875237464905
Validation Loss: 0.2633153140328692
Validation Accuracy: 0.9536830357142857
Overall accuracy: 0.9524082568807339
Overall loss: 0.2633153140328692
Early stopping
### Valid set performance:
Validation loss per 100 evaluation steps: 0.43420350551605225
Validation Loss: 0.2888545111886093
Validation Accuracy: 0.9446488681610464
Overall accuracy: 0.944949685196147
Overall loss: 0.2888545111886093
### BIO-Scheme
              precision    recall  f1-score   support

 B-CONDITION       0.91      0.67      0.77      2476
 B-TREATMENT       0.43      0.39      0.41       490
 I-CONDITION       0.83      0.79      0.81      3014
 I-TREATMENT       0.47      0.46      0.47       771
           O       0.96      0.98      0.97     48998

    accuracy                           0.94     55749
   macro avg       0.72      0.66      0.69     55749
weighted avg       0.94      0.94      0.94     55749

### Summary
              precision    recall  f1-score   support

   TREATMENT       0.46      0.44      0.45      1261
           O       0.96      0.98      0.97     48998
   CONDITION       0.86      0.74      0.80      5490

    accuracy                           0.95     55749
   macro avg       0.76      0.72      0.74     55749
weighted avg       0.94      0.95      0.94     55749

### Test set performance:
Validation loss per 100 evaluation steps: 0.16111750900745392
Validation Loss: 0.28845666689532146
Validation Accuracy: 0.9494977678571429
Overall accuracy: 0.9524082568807339
Overall loss: 0.28845666689532146
### BIO-Scheme
              precision    recall  f1-score   support

 B-CONDITION       0.90      0.69      0.78      2804
 B-TREATMENT       0.55      0.46      0.50       616
 I-CONDITION       0.83      0.78      0.80      3453
 I-TREATMENT       0.58      0.56      0.57       911
           O       0.97      0.98      0.98     61976

    accuracy                           0.95     69760
   macro avg       0.76      0.69      0.72     69760
weighted avg       0.95      0.95      0.95     69760

### Summary
              precision    recall  f1-score   support

   TREATMENT       0.57      0.52      0.54      1527
           O       0.97      0.98      0.98     61976
   CONDITION       0.86      0.74      0.80      6257

    accuracy                           0.95     69760
   macro avg       0.80      0.75      0.77     69760
weighted avg       0.95      0.95      0.95     69760

Finished with this task. 
 

Process finished!
