Spawning shell within /cluster/home/julievt/.cache/pypoetry/virtualenvs/master-project-118ajfdt-py3.12
Installing dependencies from lock file

No dependencies to install or update

Installing the current project: master-project (0.1.0)
##### Start training for NER... ######
### Processing the files:
###### (0) Training for configuration file: blocked
###### (1) Training for configuration file: a-bilstmcrf.ini
###### (2) Training for configuration file: c-bert-bilstmcrf.ini
###### (3) Training for configuration file: b-bert.ini
LOAD False
{'B-CONDITION': 0, 'B-TREATMENT': 1, 'I-CONDITION': 2, 'I-TREATMENT': 3, 'O': 4} {0: 'B-CONDITION', 1: 'B-TREATMENT', 2: 'I-CONDITION', 3: 'I-TREATMENT', 4: 'O'}
Using: cuda:0 with BERT
{'B-CONDITION': 0, 'B-TREATMENT': 1, 'I-CONDITION': 2, 'I-TREATMENT': 3, 'O': 4}
{0: 'B-CONDITION', 1: 'B-TREATMENT', 2: 'I-CONDITION', 3: 'I-TREATMENT', 4: 'O'}
[1, 120, 4923, 120, 327, 121, 3029, 1359, 28375, 120, 124, 7910, 120, 22763, 179, 18364, 1506, 49476, 399, 1733, 10453, 3957, 186, 561, 175, 2120, 4968, 128, 2546, 29159, 3957, 5066, 126, 623, 1082, 175, 460, 1108, 561, 450, 195, 395, 175, 126, 2191, 17876, 21439, 5235, 398, 759, 558, 34158, 184, 1969, 397, 552, 1359, 1480, 24614, 498, 416, 39337, 13890, 2]
['[CLS]', '.', 'pros', '.', 'Ġm', '/', 'met', 'Ġ.', 'Ġ153', '.', '2', 'ĠCa', '.', 'col', 'i', 'Ġopera', 'ta', 'ĠDiagno', 'se', 'Ġ:', 'Ġ83', '35', 'p', 'Ġ3', 'e', '15', '33', '6', 'Ġ60', 'Ġ325', '35', '36', '4', 'Ġ4', 'stand', 'e', 'ad', 'ns', 'Ġ3', 'je', 'y', 'Ġ1', 'e', '4', 'Ġus', 'just', 'seg', 'Ġfalt', 'Ġut', 'Ġnoe', 'ĠfÃ¸r', 'Ġinnleggelse', 'n', 'Ġ,', 'Ġhar', 'Ġhan', 'Ġ.', 'Ġhatt', 'Ġpose', 'Ġved', 'Ġden', 'Ġsup', 'rap', '[SEP]']
['O', 'I-CONDITION', 'I-CONDITION', 'I-CONDITION', 'B-CONDITION', 'I-CONDITION', 'I-CONDITION', 'O', 'O', 'O', 'O', 'B-CONDITION', 'I-CONDITION', 'I-CONDITION', 'I-CONDITION', 'B-CONDITION', 'I-CONDITION', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'B-CONDITION', 'I-CONDITION', 'I-CONDITION', 'I-CONDITION', 'B-CONDITION', 'I-CONDITION', 'I-CONDITION', 'I-CONDITION', 'I-CONDITION', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'B-CONDITION', 'B-CONDITION', 'B-CONDITION', 'B-CONDITION', 'I-CONDITION', 'O']
{'O': 9492430, 'B-CONDITION': 483560, 'I-CONDITION': 581376, 'B-TREATMENT': 96844, 'I-TREATMENT': 150846}
{'O': 0.22765626925876725, 'B-CONDITION': 4.468961866159319, 'I-CONDITION': 3.71706296785557, 'B-TREATMENT': 22.31435298005039, 'I-TREATMENT': 14.325943014730255}
Training Epoch: 0
Training loss epoch: 0.027913423878906746
Training accuracy epoch: 0.9705531093339087
Overall acc: 0.9705266658954188
Overall loss: 23.5868431776762
Validation loss per 100 evaluation steps: 0.04724647477269173
Validation loss per 100 evaluation steps: 0.044443041621015804
Validation loss per 100 evaluation steps: 0.04463282710552883
Validation loss per 100 evaluation steps: 0.044578963081565906
Validation loss per 100 evaluation steps: 0.044087063028776734
Validation loss per 100 evaluation steps: 0.043799460871133976
Validation loss per 100 evaluation steps: 0.043315833972181236
Validation loss per 100 evaluation steps: 0.04363097567855249
Validation loss per 100 evaluation steps: 0.04361856745883878
Validation loss per 100 evaluation steps: 0.04344374768293311
Validation loss per 100 evaluation steps: 0.04341324546758633
Validation Loss: 0.043353613836877754
Validation Accuracy: 0.9876087843769727
Overall accuracy: 0.9876012482971036
Overall loss: 0.043353613836877754
Training Epoch: 1
Training loss epoch: 0.005489944053411528
Training accuracy epoch: 0.9906818377352481
Overall acc: 0.9906767700138824
Overall loss: 4.639002725132741
Validation loss per 100 evaluation steps: 0.005016125272959471
Validation loss per 100 evaluation steps: 0.01948816887112242
Validation loss per 100 evaluation steps: 0.01985157834017297
Validation loss per 100 evaluation steps: 0.020284635532126016
Validation loss per 100 evaluation steps: 0.020500632294278332
Validation loss per 100 evaluation steps: 0.02096038320398761
Validation loss per 100 evaluation steps: 0.02120870725492313
Validation loss per 100 evaluation steps: 0.021264912431130316
Validation loss per 100 evaluation steps: 0.02139306813296798
Validation loss per 100 evaluation steps: 0.021658796753171526
Validation loss per 100 evaluation steps: 0.02178242624967362
Validation Loss: 0.02185233353320758
Validation Accuracy: 0.9939209909150095
Overall accuracy: 0.993916310045608
Overall loss: 0.02185233353320758
Training Epoch: 2
Training loss epoch: 0.004788432734985367
Training accuracy epoch: 0.9917429265029175
Overall acc: 0.9917380552984729
Overall loss: 4.0462256610626355
Validation loss per 100 evaluation steps: 0.02350432053208351
Validation loss per 100 evaluation steps: 0.018855044923118767
Validation loss per 100 evaluation steps: 0.01861555457366538
Validation loss per 100 evaluation steps: 0.018735615429824274
Validation loss per 100 evaluation steps: 0.01882589608721175
Validation loss per 100 evaluation steps: 0.01890132896404178
Validation loss per 100 evaluation steps: 0.01913711831340498
Validation loss per 100 evaluation steps: 0.019266465969849378
Validation loss per 100 evaluation steps: 0.01955205405611468
Validation loss per 100 evaluation steps: 0.019503660499338955
Validation loss per 100 evaluation steps: 0.019491367652983434
Validation Loss: 0.019561369871084797
Validation Accuracy: 0.9952096650094697
Overall accuracy: 0.9952059764259906
Overall loss: 0.019561369871084797
Training Epoch: 3
Training loss epoch: 0.004071293973719381
Training accuracy epoch: 0.9927897777469592
Overall acc: 0.9927895071726053
Overall loss: 3.4402434077928774
Validation loss per 100 evaluation steps: 0.011460239998996258
Validation loss per 100 evaluation steps: 0.01659775735974072
Validation loss per 100 evaluation steps: 0.0172636596035949
Validation loss per 100 evaluation steps: 0.017113290575527868
Validation loss per 100 evaluation steps: 0.016981331434128735
Validation loss per 100 evaluation steps: 0.017030088697267815
Validation loss per 100 evaluation steps: 0.017520322615639874
Validation loss per 100 evaluation steps: 0.017558665389582694
Validation loss per 100 evaluation steps: 0.017907121007238572
Validation loss per 100 evaluation steps: 0.01802548092435792
Validation loss per 100 evaluation steps: 0.018141744208128353
Validation Loss: 0.0180504339253854
Validation Accuracy: 0.9949991245462436
Overall accuracy: 0.9949972790677012
Overall loss: 0.0180504339253854
Training Epoch: 4
Training loss epoch: 0.004066456969036616
Training accuracy epoch: 0.9928370488936143
Overall acc: 0.9928350590004628
Overall loss: 3.4361561388359405
Validation loss per 100 evaluation steps: 0.014160575345158577
Validation loss per 100 evaluation steps: 0.020028926875894096
Validation loss per 100 evaluation steps: 0.019720114464639914
Validation loss per 100 evaluation steps: 0.020194612986847535
Validation loss per 100 evaluation steps: 0.020035559077517237
Validation loss per 100 evaluation steps: 0.019815011439099535
Validation loss per 100 evaluation steps: 0.019595559554317108
Validation loss per 100 evaluation steps: 0.019629795633697517
Validation loss per 100 evaluation steps: 0.019808626209778687
Validation loss per 100 evaluation steps: 0.01985330203768759
Validation loss per 100 evaluation steps: 0.01993679101965004
Validation Loss: 0.01988880795022741
Validation Accuracy: 0.9947989107382417
Overall accuracy: 0.9947969110939999
Overall loss: 0.01988880795022741
Training Epoch: 5
Training loss epoch: 0.0038512763277263815
Training accuracy epoch: 0.993227962817431
Overall acc: 0.9932343243868579
Overall loss: 3.2543284969287924
Validation loss per 100 evaluation steps: 0.017115967348217964
Validation loss per 100 evaluation steps: 0.028808402847314236
Validation loss per 100 evaluation steps: 0.03022810563315355
Validation loss per 100 evaluation steps: 0.029676165352838478
Validation loss per 100 evaluation steps: 0.02958428054732129
Validation loss per 100 evaluation steps: 0.03048100134361528
Validation loss per 100 evaluation steps: 0.03046748220652091
Validation loss per 100 evaluation steps: 0.030042163538032435
Validation loss per 100 evaluation steps: 0.030153089821424114
Validation loss per 100 evaluation steps: 0.03049758267887381
Validation loss per 100 evaluation steps: 0.030728562677743845
Validation Loss: 0.030677366500557666
Validation Accuracy: 0.9921455768623738
Overall accuracy: 0.9921555706924124
Overall loss: 0.030677366500557666
Training Epoch: 6
Training loss epoch: 0.0036287802592548128
Training accuracy epoch: 0.9933714455950033
Overall acc: 0.9933682322998612
Overall loss: 3.066319319070317
Validation loss per 100 evaluation steps: 0.02341039851307869
Validation loss per 100 evaluation steps: 0.015661403127325845
Validation loss per 100 evaluation steps: 0.0172908655867335
Validation loss per 100 evaluation steps: 0.01753326476425121
Validation loss per 100 evaluation steps: 0.017905123065649054
Validation loss per 100 evaluation steps: 0.01755892402884465
Validation loss per 100 evaluation steps: 0.017803286278716052
Validation loss per 100 evaluation steps: 0.018193795831520948
Validation loss per 100 evaluation steps: 0.01820088237533189
Validation loss per 100 evaluation steps: 0.017972121104892894
Validation loss per 100 evaluation steps: 0.01791977668206066
Validation Loss: 0.018117194747366675
Validation Accuracy: 0.9951620390920928
Overall accuracy: 0.9951583138364035
Overall loss: 0.018117194747366675
Early stopping
### Valid set performance:
Validation loss per 100 evaluation steps: 0.012349673546850681
Validation loss per 100 evaluation steps: 0.018469826230723962
Validation loss per 100 evaluation steps: 0.018096296434390327
Validation loss per 100 evaluation steps: 0.01772030206593264
Validation loss per 100 evaluation steps: 0.01830677632200346
Validation loss per 100 evaluation steps: 0.018535532988317425
Validation loss per 100 evaluation steps: 0.018814790175099176
Validation loss per 100 evaluation steps: 0.018721337862086605
Validation loss per 100 evaluation steps: 0.01879032106049674
Validation Loss: 0.018697186363495877
Validation Accuracy: 0.9950834363992949
Overall accuracy: 0.9950816476567114
Overall loss: 0.018697186363495877
### BIO-Scheme
              precision    recall  f1-score   support

 B-CONDITION       1.00      0.92      0.96     77258
 B-TREATMENT       0.98      0.96      0.97     15797
 I-CONDITION       1.00      0.99      0.99     92931
 I-TREATMENT       0.98      0.99      0.99     24537
           O       1.00      1.00      1.00   1518308

    accuracy                           1.00   1728831
   macro avg       0.99      0.97      0.98   1728831
weighted avg       1.00      1.00      1.00   1728831

### Summary
              precision    recall  f1-score   support

   CONDITION       1.00      0.96      0.98    170189
   TREATMENT       0.98      0.98      0.98     40334
           O       1.00      1.00      1.00   1518308

    accuracy                           1.00   1728831
   macro avg       0.99      0.98      0.99   1728831
weighted avg       1.00      1.00      1.00   1728831

### Test set performance:
Validation loss per 100 evaluation steps: 0.02238413877785206
Validation loss per 100 evaluation steps: 0.01887733548174216
Validation loss per 100 evaluation steps: 0.018741493008507238
Validation loss per 100 evaluation steps: 0.018287134286406083
Validation loss per 100 evaluation steps: 0.018201430966877877
Validation loss per 100 evaluation steps: 0.01806139626318102
Validation loss per 100 evaluation steps: 0.017864279127342723
Validation loss per 100 evaluation steps: 0.017924393938815144
Validation loss per 100 evaluation steps: 0.01806904849554973
Validation loss per 100 evaluation steps: 0.01811007735034599
Validation loss per 100 evaluation steps: 0.018083046878683735
Validation Loss: 0.018156978495054234
Validation Accuracy: 0.9951520206952337
Overall accuracy: 0.9951583138364035
Overall loss: 0.018156978495054234
### BIO-Scheme
              precision    recall  f1-score   support

 B-CONDITION       1.00      0.93      0.96     97744
 B-TREATMENT       0.99      0.96      0.97     19083
 I-CONDITION       1.00      0.99      0.99    117729
 I-TREATMENT       0.98      0.99      0.99     29823
           O       1.00      1.00      1.00   1896645

    accuracy                           1.00   2161024
   macro avg       0.99      0.97      0.98   2161024
weighted avg       1.00      1.00      1.00   2161024

### Summary
              precision    recall  f1-score   support

   CONDITION       1.00      0.96      0.98    215473
   TREATMENT       0.98      0.98      0.98     48906
           O       1.00      1.00      1.00   1896645

    accuracy                           1.00   2161024
   macro avg       0.99      0.98      0.99   2161024
weighted avg       1.00      1.00      1.00   2161024

