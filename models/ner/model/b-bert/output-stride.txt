Spawning shell within /cluster/home/julievt/.cache/pypoetry/virtualenvs/master-project-118ajfdt-py3.12
Installing dependencies from lock file

No dependencies to install or update

Installing the current project: master-project (0.1.0)
##### Start training for NER... ######
### Processing the files:
###### (0) Training for configuration file: blocked
###### (1) Training for configuration file: a-bilstmcrf.ini
###### (2) Training for configuration file: c-bert-bilstmcrf.ini
###### (3) Training for configuration file: b-bert.ini
LOAD False
{'B-CONDITION': 0, 'B-TREATMENT': 1, 'I-CONDITION': 2, 'I-TREATMENT': 3, 'O': 4} {0: 'B-CONDITION', 1: 'B-TREATMENT', 2: 'I-CONDITION', 3: 'I-TREATMENT', 4: 'O'}
Using: cuda:0 with BERT
{'B-CONDITION': 0, 'B-TREATMENT': 1, 'I-CONDITION': 2, 'I-TREATMENT': 3, 'O': 4}
{0: 'B-CONDITION', 1: 'B-TREATMENT', 2: 'I-CONDITION', 3: 'I-TREATMENT', 4: 'O'}
[1, 2964, 160, 22446, 1840, 3244, 336, 2025, 765, 24973, 1051, 1748, 325, 190, 1320, 442, 6301, 7817, 510, 124, 1475, 5220, 4917, 606, 28348, 363, 978, 4113, 46940, 14271, 163, 8706, 46739, 473, 15622, 374, 317, 556, 45993, 149, 9589, 8034, 11978, 15047, 9104, 23849, 36820, 33344, 27710, 8677, 31422, 4583, 644, 10512, 128, 5205, 143, 408, 125, 1517, 408, 123, 35817, 2]
['[CLS]', 'ĠNO', 'V', 'Ġnan', 'Ġ*', 'Ġ[', 'Ġv', 'Ġ|', 'Ġ200', 'Ġ]', 'Ġ15', 'Ġ/', 'Ġd', 't', 'ĠhÃ¸', 'ot', 'Ġ250', '89', 'ĠG', '2', 'ĠInn', 'komst', 'rapport', 'Ġle', 'pu', 'ĠÃ¥', 'Ġty', 'th', 'Ġbt', 'ĠSA', 'Y', 'ĠAP', 'PO', 'ĠP', 'IE', 'ĠD', 'Ġs', '01', 'ĠDO', 'K', 'UM', 'ENT', 'ASJON', 'ĠFRA', 'ĠAN', 'NET', 'ĠFAG', 'PER', 'SO', 'NE', 'LL', 'Ġim', 'Ġ5', 'Ġ1500', '6', 'ĠSK', 'E', 'ĠH', '3', 'Ġ25', 'ĠH', '1', 'ĠFysi', '[SEP]']
['O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O']
{'O': 306327, 'B-CONDITION': 15600, 'I-CONDITION': 18755, 'B-TREATMENT': 3124, 'I-TREATMENT': 4866}
{'O': 0.2276469263238304, 'B-CONDITION': 4.470153846153846, 'I-CONDITION': 3.7181764862703277, 'B-TREATMENT': 22.32215108834827, 'I-TREATMENT': 14.33094944512947}
Training Epoch: 0
Training loss epoch: 0.27433959394693375
Training accuracy epoch: 0.8538899739583333
Overall acc: 0.8531940261044176
Overall loss: 7.681508630514145
Validation loss per 100 evaluation steps: 0.22127248346805573
Validation Loss: 0.4997191105570112
Validation Accuracy: 0.8876395089285715
Overall accuracy: 0.8884174311926606
Overall loss: 0.4997191105570112
Training Epoch: 1
Training loss epoch: 0.10731204519314426
Training accuracy epoch: 0.9022054036458333
Overall acc: 0.9016378012048193
Overall loss: 3.004737265408039
Validation loss per 100 evaluation steps: 0.4650825262069702
Validation Loss: 0.4199339445114934
Validation Accuracy: 0.9186802455357143
Overall accuracy: 0.9164420871559633
Overall loss: 0.4199339445114934
Training Epoch: 2
Training loss epoch: 0.06972525228879281
Training accuracy epoch: 0.9166774204799106
Overall acc: 0.9156088640275387
Overall loss: 1.9523070640861988
Validation loss per 100 evaluation steps: 0.2261887490749359
Validation Loss: 0.30580089560576845
Validation Accuracy: 0.9132393973214286
Overall accuracy: 0.912141628440367
Overall loss: 0.30580089560576845
Training Epoch: 3
Training loss epoch: 0.04775250284001231
Training accuracy epoch: 0.9353477841331845
Overall acc: 0.9345551850258176
Overall loss: 1.3370700795203447
Validation loss per 100 evaluation steps: 0.36422958970069885
Validation Loss: 0.2494374537042209
Validation Accuracy: 0.9353097098214286
Overall accuracy: 0.9339592889908257
Overall loss: 0.2494374537042209
Training Epoch: 4
Training loss epoch: 0.03147369962451713
Training accuracy epoch: 0.9551978701636905
Overall acc: 0.9548461703958692
Overall loss: 0.8812635894864798
Validation loss per 100 evaluation steps: 0.2887440323829651
Validation Loss: 0.2259068140402503
Validation Accuracy: 0.9491071428571428
Overall accuracy: 0.9477064220183486
Overall loss: 0.2259068140402503
Training Epoch: 5
Training loss epoch: 0.0188722252579672
Training accuracy epoch: 0.9727251325334821
Overall acc: 0.9723537005163512
Overall loss: 0.5284223072230816
Validation loss per 100 evaluation steps: 0.3259257972240448
Validation Loss: 0.2673407390713692
Validation Accuracy: 0.9473772321428572
Overall accuracy: 0.9467889908256881
Overall loss: 0.2673407390713692
Training Epoch: 6
Training loss epoch: 0.011902463256514497
Training accuracy epoch: 0.9817528134300595
Overall acc: 0.98186944205393
Overall loss: 0.33326897118240595
Validation loss per 100 evaluation steps: 0.10805241763591766
Validation Loss: 0.2711888172796794
Validation Accuracy: 0.9496791294642857
Overall accuracy: 0.9513044724770642
Overall loss: 0.2711888172796794
Training Epoch: 7
Training loss epoch: 0.009425556287169456
Training accuracy epoch: 0.9839256649925595
Overall acc: 0.9839716006884681
Overall loss: 0.2639155760407448
Validation loss per 100 evaluation steps: 0.23902130126953125
Validation Loss: 0.32629483235733847
Validation Accuracy: 0.9446847098214286
Overall accuracy: 0.9515481651376146
Overall loss: 0.32629483235733847
Early stopping
### Valid set performance:
Validation loss per 100 evaluation steps: 0.31162029504776
Validation Loss: 0.3220775436077799
Validation Accuracy: 0.9432408467693969
Overall accuracy: 0.9431918061310517
Overall loss: 0.3220775436077799
### BIO-Scheme
              precision    recall  f1-score   support

 B-CONDITION       0.93      0.60      0.73      2476
 B-TREATMENT       0.57      0.27      0.36       490
 I-CONDITION       0.83      0.75      0.79      3014
 I-TREATMENT       0.59      0.36      0.45       771
           O       0.95      0.99      0.97     48998

    accuracy                           0.94     55749
   macro avg       0.77      0.59      0.66     55749
weighted avg       0.94      0.94      0.94     55749

### Summary
              precision    recall  f1-score   support

           O       0.95      0.99      0.97     48998
   TREATMENT       0.58      0.32      0.42      1261
   CONDITION       0.87      0.69      0.77      5490

    accuracy                           0.94     55749
   macro avg       0.80      0.67      0.72     55749
weighted avg       0.94      0.94      0.94     55749

### Test set performance:
Validation loss per 100 evaluation steps: 0.21614877879619598
Validation Loss: 0.27711356084161837
Validation Accuracy: 0.9528459821428571
Overall accuracy: 0.9515481651376146
Overall loss: 0.27711356084161837
### BIO-Scheme
              precision    recall  f1-score   support

 B-CONDITION       0.91      0.61      0.73      2804
 B-TREATMENT       0.70      0.38      0.49       616
 I-CONDITION       0.84      0.75      0.79      3453
 I-TREATMENT       0.70      0.49      0.58       911
           O       0.96      0.99      0.98     61976

    accuracy                           0.95     69760
   macro avg       0.82      0.64      0.71     69760
weighted avg       0.95      0.95      0.95     69760

### Summary
              precision    recall  f1-score   support

           O       0.96      0.99      0.98     61976
   TREATMENT       0.70      0.44      0.54      1527
   CONDITION       0.87      0.69      0.77      6257

    accuracy                           0.95     69760
   macro avg       0.85      0.71      0.76     69760
weighted avg       0.95      0.95      0.95     69760

Finished with this task. 
 

Process finished!
